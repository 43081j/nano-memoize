(function(){"use strict";const hsVrgs=f=>{const s=f+"",i=s.indexOf("...");return i>=0&&i<s.indexOf(")"||s.indexOf("arguments")>=0)};function nanomemoize(fn,options={}){const{serializer:serializer=(value=>JSON.stringify(value)),equals:equals,maxAge:maxAge,maxArgs:maxArgs,vargs:vargs=hsVrgs(fn)}=options,s={},k=[],v=[];function sngl(f,s,chng,serializer,arg){const key=!arg||typeof arg==="number"||typeof arg==="boolean"?arg:serializer(arg);return s[key]||(chng(key),s[key]=f.call(this,arg))}function mltpl(f,k,v,eq,chng,max=0,...args){const rslt={};for(let i=0;i<k.length;i++){let key=k[i];if(max){key=key.slice(0,max)}if(key.length===args.length||max&&key.length<args.length){const max=key.length-1;for(let j=0;j<=max;j++){if(!eq(key[j],args[j])){break}if(j===max){rslt.i=i;rslt.v=v[i]}}}}const i=rslt.i>=0?rslt.i:v.length;return typeof rslt.v==="undefined"||rslt.v===undefined?(chng(i),v[i]=f.call(this,...k[i]=args)):rslt.v}let m,unry=fn.length===1&&!equals&&!vargs;if(unry){m=sngl.bind(this,fn,s,maxAge&&maxAge<Infinity?key=>setTimeout(()=>{delete s[key]},maxAge):()=>{},serializer)}else{m=mltpl.bind(this,fn,k,v,equals||((a,b)=>a===b),maxAge&&maxAge<Infinity?key=>setTimeout(()=>{delete v[key]},maxAge):()=>{},maxArgs)}m.clear=(()=>{Object.keys(s).forEach(k=>delete s[k]);k.length=0;v.length=0});m.keys=(()=>!unry?k.slice():null);m.values=(()=>!unry?v.slice():null);m.keyValues=(()=>unry?Object.assign({},s):null);return m}if(typeof module!=="undefined")module.exports=nanomemoize;if(typeof window!=="undefined")window.nanomemoize=nanomemoize}).call(this);